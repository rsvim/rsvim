[package]
name = "rsvim"
version.workspace = true
edition.workspace = true
rust-version.workspace = true
authors.workspace = true
repository.workspace = true
readme.workspace = true
homepage.workspace = true
documentation.workspace = true
license.workspace = true
keywords.workspace = true
categories.workspace = true
exclude.workspace = true
description = "The command line(s) for the RSVIM editor."

[features]
default = []
allocator = ["dep:mimalloc-safe"]

[dependencies]
rsvim_core = { workspace = true }
tracing = { workspace = true }
tokio = { workspace = true, features = ["full"] }
clap = { workspace = true, features = ["derive", "unicode"] }
toml = { workspace = true }
once_cell = { workspace = true, features = ["parking_lot"] }
zstd = { workspace = true }

# windows && aarch64
[target.'cfg(all(target_os = "windows", target_arch = "aarch64"))'.dependencies]
mimalloc-safe = { workspace = true, features = [
  "no_opt_arch",
], optional = true }

# windows && !aarch64
[target.'cfg(all(target_os = "windows", not(target_arch = "aarch64")))'.dependencies]
mimalloc-safe = { workspace = true, optional = true }

# linux && !aarch64
[target.'cfg(all(target_os = "linux", not(target_arch = "aarch64")))'.dependencies]
mimalloc-safe = { workspace = true, features = [
  "local_dynamic_tls",
], optional = true }

# linux && aarch64
[target.'cfg(all(target_os = "linux", target_arch = "aarch64"))'.dependencies]
mimalloc-safe = { workspace = true, features = [
  "local_dynamic_tls",
  "no_opt_arch",
], optional = true }

# !linux && !windows
[target.'cfg(not(any(target_os = "linux", target_os = "windows")))'.dependencies]
mimalloc-safe = { workspace = true, optional = true }

[build-dependencies]
rsvim_core = { workspace = true }
tokio = { workspace = true, features = ["full"] }
zstd = { workspace = true }
